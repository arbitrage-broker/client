ajaxUrl="/api/v1/user";var myDropzone,referralDataTable1,referralDataTable2,imageProfileUrl="";let isSubmitting=!1;function loadTable(){referralDataTable1=initAjaxTable("#referral-table-1",[{data:"profileImageUrl",searchable:!1,sortable:!1,render:function(e){return`<img src="${isNullOrEmpty(e)?"/images/find_user.png":e}" style="width: 35px;"></img>`}},{data:"firstName",render:function(e,a,r){return e+" "+r.lastName}},{data:"userName"},{data:"email"},{data:"uid"},{data:"country.name"},{data:"deposit"},{data:"withdrawal"},{data:"reward"},{data:"modifiedDate",render:function(e){return toLocalizingDateString(e,!0)}}],"/api/v1/user","loadSearchReferralEntity1ByInput"),$.subscribe("reloadReferral1Table",referralDataTable1.ajax.reload),referralDataTable2=initAjaxTable("#referral-table-2",[{data:"profileImageUrl",searchable:!1,sortable:!1,render:function(e){return`<img src="${isNullOrEmpty(e)?"/images/find_user.png":e}" style="width: 35px;"></img>`}},{data:"firstName",render:function(e,a,r){return e+" "+r.lastName}},{data:"userName"},{data:"email"},{data:"uid"},{data:"country.name"},{data:"deposit"},{data:"withdrawal"},{data:"reward"},{data:"modifiedDate",render:function(e){return toLocalizingDateString(e,!0)}}],"/api/v1/user","loadSearchReferralEntity2ByInput"),$.subscribe("reloadReferral2Table",referralDataTable2.ajax.reload)}function customTableOptions(){let e=tableOptions();return e.order=[[9,"desc"]],e}function loadInputByEntity(e){$.getJSON(`${ajaxUrl}/${e}`,function(e){$("#countrySelect2").html("<option value='"+get(()=>e.country.id)+"' selected>"+get(()=>e.country.name)+"</option>").trigger("change"),$("#countrySelect2").val(get(()=>e.country.id)).trigger("change"),$("#email").val(e.email),$("#name").val(e.firstName),$("#lastName").val(e.lastName),$("#walletAddress").val(e.walletAddress)})}function loadLabelByEntity(e){$.getJSON(`${ajaxUrl}/${e}`,function(e){isNullOrEmpty(e.profileImageUrl)||$("#profile-image-url").attr("src",e.profileImageUrl),$("#full-name").text(`${e.selectTitle}`),$("#country-label").html(`<strong><i class="fa fa-map-marker"></i> Country:</strong> ${e.country.name}`),$("#email-label").html(`<strong><i class="fa fa-envelope"></i> Email:</strong> ${e.email}`),$("#user-name").html(`<strong><i class="fa fa-id-card"></i> UserName:</strong> ${e.userName}`),$("#wallet-label").html(`${isNullOrEmpty(e.walletAddress)?'<strong><i class="fa fa-wallet"></i> Wallet:</strong> ---':'<strong><i class="fa fa-wallet"></i> Wallet:</strong> '+e.walletAddress}`);let a=window.location.origin+`/login?referralCode=${e.uid}#signup`;$(".referral-code").attr("href",a),$(".referral-code").html(`${e.uid}`)})}function loadSaveEntityByInput(){return{id:currentUser.id,userName:currentUser.userName,firstName:$("#name").val(),lastName:$("#lastName").val(),version:currentUser.version,email:$("#email").val(),country:{id:$("#countrySelect2").val()},walletAddress:$("#walletAddress").val(),profileImageUrl:imageProfileUrl,password:$("#password").val()}}function loadSearchReferralEntity1ByInput(){return{parentId:currentUser.id}}function loadSearchReferralEntity2ByInput(){return{treePath:currentUser.treePath+",%,%"}}function updateUser(){$("#myModal form").submit()}function clearAll_(){$("#walletAddress,#email,#name,#lastName, input:password").val(""),$("#countrySelect2").val("").trigger("change"),myDropzone.removeAllFiles(!0)}function onLoad(){$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){let a=$(e.target).attr("href");$(a).find(".table").DataTable().columns.adjust().responsive.recalc()}),myDropzone=new Dropzone(".dropzone",{url:"/api/v1/files",maxFiles:1,init:function(){this.on("success",function(e,a){imageProfileUrl=a.url}),this.on("maxfilesexceeded",function(e){this.removeAllFiles(),this.addFile(e),$.ajax({type:"DELETE",url:"/api/v1/files/"+imageProfileUrl.substring(imageProfileUrl.lastIndexOf("/")+1),dataType:"json",contentType:"application/json",success:function(e){void 0==e?show_success(resources.deleteSuccess):show_error(e.error)},error:function(e,a,r){isNullOrEmpty(get(()=>e.responseJSON))?show_error("ajax answer post returned error: "+e.responseText):show_error(e.responseJSON.error+" ("+e.responseJSON.status+") <br>"+e.responseJSON.message)}})})}}),$("#myModal form").validate({rules:{name:"required",lastName:"required",walletAddress:{validTronWallet:!0},countrySelect2:"required",password:{minlength:5},repeatPassword:{minlength:5,equalTo:"#password"},email:{required:!0,email:!0}},messages:{name:resources.pleaseEnter.format(resources.name),lastName:resources.pleaseEnter.format(resources.lastName),walletAddress:{validTronWallet:resources.invalidFormat.format(resources.wallet)},countrySelect2:resources.pleaseSelect.format(resources.country),password:{minlength:resources.mustBeMoreThan.format(resources.password,5,resources.character)},repeatPassword:{minlength:resources.mustBeMoreThan.format(resources.password,5,resources.character),equalTo:resources.confirmPasswordDoesNotMach},email:{required:resources.pleaseEnter.format(resources.email),email:resources.invalidFormat.format(resources.email)}},highlight:function(e){$(e).addClass("is-invalid").closest("div").addClass("bad")},unhighlight:function(e){$(e).removeClass("is-invalid").closest("div").removeClass("bad")},errorElement:"span",errorClass:"invalid-feedback",errorPlacement:function(e,a){e.insertAfter(a)},submitHandler:function(e){if(isSubmitting)return;isSubmitting=!0,$("#myModal .modal-content").block(blockUiOptions());let a=loadSaveEntityByInput();$.ajax({type:"PATCH",url:`${ajaxUrl}/${a.id}`,dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(a),success:function(e){$("#myModal .modal-content").unblock(),null==e.error?(clearAll(),loadLabelByEntity(currentUser.id),show_success(resources.saveSuccess)):show_error(e.error),isSubmitting=!1},error:function(e,a,r){$("#myModal .modal-content").unblock(),isSubmitting=!1,isNullOrEmpty(get(()=>e.responseJSON))?show_error("ajax answer post returned error: "+r.responseText):e.responseJSON.status>=400&&e.responseJSON.status<500?show_warning(e.responseJSON.error+" ("+e.responseJSON.status+") <br>"+e.responseJSON.message):show_error(e.responseJSON.error+" ("+e.responseJSON.status+") <br>"+e.responseJSON.message)}})}})}rules={walletAddress:{validTronWallet:!0}},messages={walletAddress:{validTronWallet:resources.invalidFormat.format(resources.wallet)}},$(function(){$("#full-name").text(`${currentUser.selectTitle}`),$("#country-label").html(`<strong><i class="fa fa-map-marker"></i> Country:</strong> ${currentUser.country.name}`),$("#email-label").html(`<strong><i class="fa fa-envelope"></i> Email:</strong> ${currentUser.email}`),$("#user-name").html(`<strong><i class="fa fa-id-card"></i> UserName:</strong> ${currentUser.userName}`),$("#wallet-label").html(`${isNullOrEmpty(currentUser.walletAddress)?'<strong><i class="fa fa-wallet"></i> Wallet:</strong> ---':'<strong><i class="fa fa-wallet"></i> Wallet:</strong> '+currentUser.walletAddress}`);let e=window.location.origin+`/login?referralCode=${currentUser.uid}#signup`;$(".referral-code").attr("href",e),$(".referral-code").html(`${currentUser.uid}`),$(".toggle-password").click(function(){$(this).toggleClass("fa-eye fa-eye-slash");var e=$(this).prev("input");"password"==e.attr("type")?e.attr("type","text"):e.attr("type","password")}),$("#modal-body").validate({messages:{password:{minlength:resources.mustBeMoreThan.format(resources.password,5,resources.character)},email:{email:resources.invalidFormat.format(resources.email)},repeatPassword:{minlength:resources.mustBeMoreThan.format(resources.password,5,resources.character),equalTo:resources.confirmPasswordDoesNotMach}},rules:{password:{minlength:5},email:{email:!0},repeatPassword:{minlength:5,equalTo:"#password"}},highlight:function(e){$(e).addClass("is-invalid").closest("div").addClass("bad")},unhighlight:function(e){$(e).removeClass("is-invalid").closest("div").removeClass("bad")},errorElement:"span",errorClass:"invalid-feedback",errorPlacement:function(e,a){e.insertAfter(a)}}),loadLabelByEntity(currentUser.id)}),Dropzone.autoDiscover=!1;