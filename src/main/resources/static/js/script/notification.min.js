function onLoad(){let e=getURLParameter("id");isNullOrEmpty(e)||loadContent(e,"#inbox-body"),$.getJSON("api/v1/notification/findAll-by-recipientId/"+currentUser.id+"?sort=read,desc",function(e){$("#inbox-list").empty(),e.content.forEach(function(e){let t=`<a href="javascript:loadContent(${e.id},'#inbox-body')">
                                <div class="mail_list">
                                    <div class="left">
                                        ${e.read?"":'<i class="fa fa-circle"></i>'} <i class="fa fa-edit"></i>
                                    </div>
                                    <div class="right">
                                        <h3>${e.sender.selectTitle} <small>${toTimeString(e.createdDate)}</small></h3>
                                        <p>${e.subject.length>98?e.subject.substring(0,98)+"...":e.subject}</p>
                                    </div>
                                </div>
                            </a>`;$("#inbox-list").append(t)})}),$.getJSON("api/v1/notification/findAll-by-senderId/"+currentUser.id+"?sort=read,desc",function(e){e.content.forEach(function(e){let t=`<a href="javascript:loadContent(${e.id},'#sent-body')">
                                <div class="mail_list">
                                    <div class="left">
                                        ${e.read?"":'<i class="fa fa-circle"></i>'} <i class="fa fa-edit"></i>
                                    </div>
                                    <div class="right">
                                        <h3>${e.sender.selectTitle} <small>${toTimeString(e.createdDate)}</small></h3>
                                        <p>${e.subject.length>98?e.subject.substring(0,98)+"...":e.subject}</p>
                                    </div>
                                </div>
                            </a>`;$("#sent-list").append(t)})})}function loadContent(e,t){$.getJSON(`${ajaxUrl}/${e}`,function(e){$(t).html(`<div class="mail_heading row">                                  
                                    <div class="col-md-12 text-left">
                                        <p class="date"> ${toDateTimeString(e.createdDate)}</p>
                                    </div>
                                    <div class="col-md-12">
                                        <h4> ${e.subject}</h4>
                                    </div>
                                </div>
                                <div class="sender-info">
                                    <div class="row">
                                        <div class="col-md-12">
                                            ${currentUser.id===e.sender.id?"<strong>me</strong>":`<strong>${e.sender.selectTitle}</strong> <span>(${e.sender.email})</span>`}
                                            to
                                            ${currentUser.id===e.recipient.id?"<strong>me</strong>":`<strong>${e.recipient.selectTitle}</strong> <span>(${e.recipient.email})</span>`}
                                            <a class="sender-dropdown"><i class="fa fa-chevron-down"></i></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="view-mail">
                                    <p>${e.body} </p>                                   
                                </div>`)})}function loadSaveEntityByInput(){return{sender:{id:currentUser.id},subject:$("#subject").val(),body:$("#body").val()}}function sendNotification(){let e=loadSaveEntityByInput();$.blockUI(blockUiOptions()),$("#sendNotification").attr("disabled","disabled"),$.ajax({type:"POST",url:ajaxUrl+"/support",dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(e),success:function(e){$.unblockUI(),$("#sendNotification").removeAttr("disabled"),null==e.error?(clearModal(),$("#send-notification-modal").modal("hide"),show_success(resources.sentSuccess),onLoad()):show_error(e.error)},error:function(e,t,i){$.unblockUI(),$("#sendNotification").removeAttr("disabled"),isNullOrEmpty(get(()=>e.responseJSON))?show_error("ajax answer post returned error: "+i.responseText):show_error(e.responseJSON.error+" ("+e.responseJSON.status+") <br>"+e.responseJSON.message)}})}function clearModal(){$("#body,#subject").val("")}